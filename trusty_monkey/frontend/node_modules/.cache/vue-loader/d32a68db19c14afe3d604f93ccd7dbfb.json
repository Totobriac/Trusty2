{"remainingRequest":"/home/pi/Downloads/trustymonkey/trusty_monkey/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/pi/Downloads/trustymonkey/trusty_monkey/frontend/src/components/ReviewEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/pi/Downloads/trustymonkey/trusty_monkey/frontend/src/components/ReviewEditor.vue","mtime":1601917457000},{"path":"/home/pi/Downloads/trustymonkey/trusty_monkey/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/Downloads/trustymonkey/trusty_monkey/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/Downloads/trustymonkey/trusty_monkey/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/pi/Downloads/trustymonkey/trusty_monkey/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/Downloads/trustymonkey/trusty_monkey/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHN0b3JlIH0gZnJvbSAiLi4vY29tbW9uL3N0b3JlLmpzIgppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnCmltcG9ydCB7IENTUkZfVE9LRU4gfSBmcm9tICIuLi9jb21tb24vY3NyZl90b2tlbi5qcyIKaW1wb3J0IFBpY3R1cmVVcGxvYWQgZnJvbSAiQC9jb21wb25lbnRzL1BpY3R1cmVVcGxvYWQudnVlIjsKaW1wb3J0IFJlc2l6ZSBmcm9tICJAL2NvbXBvbmVudHMvUmVzaXplLnZ1ZSIKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJSZXZpZXdFZGl0b3IiLAogIGNvbXB1dGVkOnsKICAgIHN0b3JlU3RhdGUoKXsKICAgICAgcmV0dXJuIHN0b3JlLnN0YXRlOwogICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZXJyb3I6IG51bGwsCiAgICAgIHNlbGVjdGVkRmlsZTogbnVsbCwKICAgICAgdXBVcmw6IG51bGwsCiAgICAgIHVwVXJsQXJyYXk6IFtdLCAgICAgIAogICAgICBlbmRwb2ludDogbnVsbCwgICAgICAKICAgICAgbmV3UGljdHVyZVVybDogbnVsbCwgICAgICAgICAgICAKICAgICAgYnV0dG9uUGljczogWydFbnRyw6llJywgJ1BsYXQtcHJpbmNpcGFsJywKICAgICAgICAgICAgICAgICAgJ0Rlc3NlcnQnLCAnTWVudScsICdFeHTDqXJpZXVyJywKICAgICAgICAgICAgICAgICAgJ0ludMOpcmlldXInXSwgICAgICAKICAgIH0KICB9LAogIHByb3BzOiB7CiAgICBpZDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9LAogIH0sICAKICBtZXRob2RzOiB7CiAgICBvblVwbG9hZCgpIHsKICAgICAgY29uc29sZS5sb2codGhpcy51cFVybEFycmF5KQogICAgICBpZiAodGhpcy5zdG9yZVN0YXRlLmxhYmVscykgeyAKICAgICAgICB0aGlzLnNlbGVjdGVkRmlsZSA9IHRoaXMuc3RvcmVTdGF0ZS5maWxlICAgICAgICAgICAgCiAgICAgICAgY29uc3QgZmQgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICBsZXQgYXhpb3NDb25maWcgPSB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdYLUNTUkZUT0tFTic6IENTUkZfVE9LRU4sICAgICAgICAgICAKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAodGhpcy51cFVybCA9PSAwKSB7ICAgICAgICAKICAgICAgICAgIGlmICh0aGlzLnN0b3JlU3RhdGUubGFiZWxzLmluY2x1ZGVzICgnRm9vZCcpKSB7CiAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gInN0YXJ0ZXJfcGljIiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMuc3RvcmVTdGF0ZS51cEVycm9yID0gbnVsbH0KICAgICAgICAgICAgICBlbHNlIHtzdG9yZS5zZXRVcEVycm9yKCJDZWNpIG4nZXN0IHBhcyBsYSBwaG90byBkJ3VuZSBlbnRyw6llIiksICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgc3RvcmUuc2V0U2hvd0NhdEJ1dCgpfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy51cFVybCA9PSAxKSB7CiAgICAgICAgICBpZiAodGhpcy5zdG9yZVN0YXRlLmxhYmVscy5pbmNsdWRlcyAoJ0Zvb2QnKSkgewogICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9ICJtYWluX3BpYyIgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlU3RhdGUudXBFcnJvciA9IG51bGx9CiAgICAgICAgICAgICAgZWxzZSB7c3RvcmUuc2V0VXBFcnJvcigiQ2VjaSBuJ2VzdCBwYXMgbGEgcGhvdG8gZCd1biBwbGF0IiksICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgc3RvcmUuc2V0U2hvd0NhdEJ1dCgpfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy51cFVybCA9PSAyKSB7ICAgICAgICAgIAogICAgICAgICAgICAgIGlmICh0aGlzLnN0b3JlU3RhdGUubGFiZWxzLmluY2x1ZGVzICgnRGVzc2VydCcpKSB7CiAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gImRlc3NlcnRfcGljIiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMuc3RvcmVTdGF0ZS51cEVycm9yID0gbnVsbH0KICAgICAgICAgICAgICBlbHNlIHtzdG9yZS5zZXRVcEVycm9yKCJDZWNpIG4nZXN0IHBhcyBsYSBwaG90byBkJ3VuIGRlc3NlcnQiKSwgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kcG9pbnQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBzdG9yZS5zZXRTaG93Q2F0QnV0KCl9CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnVwVXJsID09IDMpIHsgICAgICAgICAgCiAgICAgICAgICAgICAgaWYgKHRoaXMuc3RvcmVTdGF0ZS5sYWJlbHMuaW5jbHVkZXMgKCdUZXh0JykpIHsKICAgICAgICAgICAgICAgIHRoaXMuZW5kcG9pbnQgPSAibWVudV9waWMiICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdGhpcy5zdG9yZVN0YXRlLnVwRXJyb3IgPSBudWxsfQogICAgICAgICAgICAgIGVsc2Uge3N0b3JlLnNldFVwRXJyb3IoIkNlY2kgbidlc3QgcGFzIGxhIHBob3RvIGQndW4gbWVudSIpLCAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHN0b3JlLnNldFNob3dDYXRCdXQoKX0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMudXBVcmwgPT0gNCkgewogICAgICAgICAgaWYgKHRoaXMuc3RvcmVTdGF0ZS5sYWJlbHMuaW5jbHVkZXMgKCdCdWlsZGluZycpKSB7CiAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gIm91dHNpZGVfcGljIiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMuc3RvcmVTdGF0ZS51cEVycm9yID0gbnVsbH0KICAgICAgICAgICAgICBlbHNlIHtzdG9yZS5zZXRVcEVycm9yKCJDZWNpIG4nZXN0IHBhcyB1bmUgcGhvdG8gZGUgbCdleHTDqXJpZXVyIGR1IHJlc3RhdXJhbnQiKSwgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kcG9pbnQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBzdG9yZS5zZXRTaG93Q2F0QnV0KCl9CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnVwVXJsID09IDUpIHsKICAgICAgICAgIGlmICh0aGlzLnN0b3JlU3RhdGUubGFiZWxzLmluY2x1ZGVzICgnUmVzdGF1cmFudCcpKSB7CiAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gImluc2lkZV9waWMiICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdGhpcy5zdG9yZVN0YXRlLnVwRXJyb3IgPSBudWxsfQogICAgICAgICAgICAgIGVsc2Uge3N0b3JlLnNldFVwRXJyb3IoIkNlY2kgbidlc3QgcGFzIHVuZSBwaG90byBkZSBsJ2ludGVyaWV1ciBkdSByZXN0YXVyYW50IiksICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgc3RvcmUuc2V0U2hvd0NhdEJ1dCgpfQogICAgICAgIH0gCiAgICAgICAgCiAgICAgICAgaWYgKHRoaXMuZW5kcG9pbnQgIT0gZmFsc2UpewogICAgICAgICAgY29uc29sZS5sb2codGhpcy5lbmRwb2ludCkKICAgICAgICAgIGZkLmFwcGVuZCgncGljdHVyZV8xJywgdGhpcy5zZWxlY3RlZEZpbGUpCiAgICAgICAgICBmZC5hcHBlbmQoJ3Jlc3RhdXJhbnRfcmV2aWV3JywgdGhpcy5pZCkKICAgICAgICAgIGF4aW9zLnBvc3QoYGh0dHBzOi8vdHJ1c3R5bW9ua2V5Lmhlcm9rdWFwcDIuY29tL2FwaS8ke3RoaXMuZW5kcG9pbnR9L2AsIGZkLCBheGlvc0NvbmZpZykKICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgdGhpcy51cFVybCA9IG51bGwgICAgICAgICAgICAgIAogICAgICAgICAgICAgIHN0b3JlLnNldFNob3dDYXRCdXQoKSAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgbGV0IG5ld1BpY3R1cmVVcmwgPSByZXMuZGF0YS5waWN0dXJlXzEKICAgICAgICAgICAgICBsZXQgbmV3UGljdHVyZUlkID0gcmVzLmRhdGEuaWQKICAgICAgICAgICAgICBsZXQgYXBpVVJMID0gcmVzLmNvbmZpZy51cmwKICAgICAgICAgICAgICBsZXQgYWRkUGljRGljID0geyJ1cmwiOiBuZXdQaWN0dXJlVXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaWQiOiBuZXdQaWN0dXJlSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhcGlVcmwiOiBhcGlVUkwgIH0gICAgICAgICAgCiAgICAgICAgICAgICAgc3RvcmUuYWRkUGljdHVyZShhZGRQaWNEaWMpICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0gCiAgICB9LAogICAgZ29Ib21lKCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7bmFtZTogJ2hvbWUnfSkgICAgICAgICAgIAogICAgfSwKICAgIHNldFVwVXJsKCkgewogICAgICB0aGlzLnVwVXJsQXJyYXkucHVzaCh0aGlzLnVwZXgpCiAgICAgIGlmICh0aGlzLnVwVXJsQXJyYXkubGVuZ3RoID4gMSAmJiB0aGlzLnVwVXJsQXJyYXkubGVuZ3RoICUgMiA9PSAwKSB7CiAgICAgICAgdGhpcy51cFVybCA9IHRoaXMudXBVcmxBcnJheVt0aGlzLnVwVXJsQXJyYXkubGVuZ3RoIC0gMl0KICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnVwVXJsKQogICAgICAgIHN0b3JlLnNldFNob3dDYXRCdXQoKQogICAgICAgIHRoaXMuc3RvcmVTdGF0ZS51cEVycm9yID0gbnVsbAogICAgICB9CiAgICB9ICAgCiAgfSwgCiAgY29tcG9uZW50czogewogICAgUGljdHVyZVVwbG9hZCwKICAgIFJlc2l6ZQogICAgfSwKICB3YXRjaDogewogICAgInN0b3JlU3RhdGUubGFiZWxzIjogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLm9uVXBsb2FkKCkKICAgICAgfSAKICAgIH0gCiAgfQo="},{"version":3,"sources":["ReviewEditor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ReviewEditor.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<div class=\"editor\">\n\n  <div>\n    <PictureUpload/>    \n    <hr/>\n  </div>\n\n  <div>\n\n  <div class=\"container text-center\" v-show=\"this.storeState.preLoader\">\n    <div>\n      <img src=\"https://media.giphy.com/media/pFwRzOLfuGHok/giphy.gif\" class=\"w-25\">\n    </div>   \n  </div> \n\n  <div v-show=\"this.storeState.showCatBut == true\">\n    <div class=\"btnRow d-flex flex-row justify-content-around\">\n      <div class=\"mt-3\" v-for=\"(buttonPic, index) in buttonPics\" :key=\"buttonPic\">\n\n        <label for=\"fileInput\" @click=\"upex=index, setUpUrl()\"\n              class=\"catBtn border border-success rounded p-2\"\n        >{{ buttonPic }} <Resize/> </label>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"d-flex flex-row \">      \n        <button class=\"btn btn-success btn-sm m-3 \" \n                @click=\"goHome\">Soumettre</button>\n        <div v-show=\"this.storeState.upError != null\"\n              class=\"container border border-danger rounded w-50 h-50 m-auto text-center\">\n          <p  class=\"text-danger my-auto\">{{ this.storeState.upError }}</p>\n        </div>\n  </div>  \n\n  </div>\n</div> \n</template>\n\n<script>\nimport { store } from \"../common/store.js\"\nimport axios from 'axios'\nimport { CSRF_TOKEN } from \"../common/csrf_token.js\"\nimport PictureUpload from \"@/components/PictureUpload.vue\";\nimport Resize from \"@/components/Resize.vue\"\nexport default {\n  name: \"ReviewEditor\",\n  computed:{\n    storeState(){\n      return store.state;\n   }\n  },\n  data() {\n    return {\n      error: null,\n      selectedFile: null,\n      upUrl: null,\n      upUrlArray: [],      \n      endpoint: null,      \n      newPictureUrl: null,            \n      buttonPics: ['Entrée', 'Plat-principal',\n                  'Dessert', 'Menu', 'Extérieur',\n                  'Intérieur'],      \n    }\n  },\n  props: {\n    id: {\n      type: Number,\n      required: true\n    },\n  },  \n  methods: {\n    onUpload() {\n      console.log(this.upUrlArray)\n      if (this.storeState.labels) { \n        this.selectedFile = this.storeState.file            \n        const fd = new FormData();\n        let axiosConfig = {\n          headers: {\n            'X-CSRFTOKEN': CSRF_TOKEN,           \n          }\n        };\n\n        if (this.upUrl == 0) {        \n          if (this.storeState.labels.includes ('Food')) {\n                this.endpoint = \"starter_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'une entrée\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 1) {\n          if (this.storeState.labels.includes ('Food')) {\n                this.endpoint = \"main_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un plat\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 2) {          \n              if (this.storeState.labels.includes ('Dessert')) {\n                this.endpoint = \"dessert_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un dessert\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 3) {          \n              if (this.storeState.labels.includes ('Text')) {\n                this.endpoint = \"menu_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un menu\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 4) {\n          if (this.storeState.labels.includes ('Building')) {\n                this.endpoint = \"outside_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas une photo de l'extérieur du restaurant\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 5) {\n          if (this.storeState.labels.includes ('Restaurant')) {\n                this.endpoint = \"inside_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas une photo de l'interieur du restaurant\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } \n        \n        if (this.endpoint != false){\n          console.log(this.endpoint)\n          fd.append('picture_1', this.selectedFile)\n          fd.append('restaurant_review', this.id)\n          axios.post(`https://trustymonkey.herokuapp2.com/api/${this.endpoint}/`, fd, axiosConfig)\n            .then(res => {                                  \n              this.upUrl = null              \n              store.setShowCatBut()              \n              let newPictureUrl = res.data.picture_1\n              let newPictureId = res.data.id\n              let apiURL = res.config.url\n              let addPicDic = {\"url\": newPictureUrl,\n                              \"id\": newPictureId,\n                              \"apiUrl\": apiURL  }          \n              store.addPicture(addPicDic)                            \n          })\n        }\n      } \n    },\n    goHome() {\n      this.$router.push({name: 'home'})           \n    },\n    setUpUrl() {\n      this.upUrlArray.push(this.upex)\n      if (this.upUrlArray.length > 1 && this.upUrlArray.length % 2 == 0) {\n        this.upUrl = this.upUrlArray[this.upUrlArray.length - 2]\n        console.log(this.upUrl)\n        store.setShowCatBut()\n        this.storeState.upError = null\n      }\n    }   \n  }, \n  components: {\n    PictureUpload,\n    Resize\n    },\n  watch: {\n    \"storeState.labels\": function () {\n      this.onUpload()\n      } \n    } \n  }\n</script>\n\n<style>\n.editor {\n  background-color: white;\n  border: 1px solid \n}\n.custom-file-label {\n  background-color: rgb(234, 236, 122);\n}\n.btnRow {\n  background-color: white\n}\n.catBtn:hover {\n  background-color: #5cb85c;\n  color: white\n}\n</style>"]}]}